# 완전제외 전략 인식 안됨 - 키 형식 문제 분석

## 발견 시간
2025-08-27

## 문제 상황
완전제외 전략이 193개 로드되지만 실제 시뮬레이션에서는 0개가 제외됨:
```
- 완전제외: 193 (5회+ 탈락 + 3시장 모두탈락)
→ 제외된 전략: 0개, 실제 투입: 340340개
```

## 디버깅 결과
1. **완전제외 전략 키**: `연속상승 + 10주 + 손절-7.0% + 일괄4.5%`
2. **생성된 전략 키**: `기본매수 + 10% + 손절-0.5% + 기본매도1.5%`

## 원인 분석
**키 형식 불일치**:
- JSON 완전제외: `연속상승` (매수기준), `10주` (매수수량)
- 실제 생성: `기본매수` (매수기준), `10%` (매수수량)

**문제 요소**:
1. **매수기준**: `연속상승` vs `기본매수`
2. **매수수량**: `10주` vs `10%` (방식1과 방식2 차이)

## 원인 추정
```python
매수수량들 = [
    {'방식': '1', '이름': '10%', '수량': 0.1},      # 퍼센트 방식
    {'방식': '1', '이름': '30%', '수량': 0.3},
    {'방식': '1', '이름': '50%', '수량': 0.5},
    {'방식': '2', '이름': '5주', '수량': 5},        # 고정주식수 방식
    {'방식': '2', '이름': '10주', '수량': 10}
]
```

**첫 번째 생성 전략**이 `기본매수 + 10%`로 시작하는 것으로 봐서:
- `연속상승` 매수기준 전략이 생성되지 않거나
- `10주` 방식 전략이 나중에 생성되거나
- 키 변환 과정에서 형식이 달라짐

## 추가 확인 필요
1. `연속상승` 매수기준이 실제 전략 생성에 포함되는지
2. 방식2 (`10주`) 전략이 생성되는지
3. 키 변환 함수가 JSON 저장시와 동일한 형식으로 작동하는지

## 임시 해결
디버깅 코드 제거하여 성능 복구.

## 확신도
90% - 키 형식 불일치가 주요 원인이지만 추가 분석 필요.